# ============================================================================
# ConfigMap - Application Configuration
# ============================================================================
# Configurações não-sensíveis da aplicação
#
# Para dados sensíveis (passwords, tokens), use Secrets!
# ============================================================================

apiVersion: v1
kind: ConfigMap
metadata:
  name: wine-quality-config
  namespace: default
  labels:
    app: wine-quality-api

data:
  # --------------------------------------------------------------------------
  # Application Settings
  # --------------------------------------------------------------------------
  APP_NAME: "Wine Quality Prediction API"
  APP_VERSION: "1.0.0"
  ENVIRONMENT: "production"
  LOG_LEVEL: "info"
  
  # --------------------------------------------------------------------------
  # API Settings
  # --------------------------------------------------------------------------
  API_HOST: "0.0.0.0"
  API_PORT: "8000"
  API_WORKERS: "2"
  API_RELOAD: "false"  # Disable em produção
  
  # --------------------------------------------------------------------------
  # Model Settings
  # --------------------------------------------------------------------------
  MODEL_PATH: "/app/models/model.pkl"
  MODEL_VERSION: "v1.0.0"
  
  # --------------------------------------------------------------------------
  # Feature Flags
  # --------------------------------------------------------------------------
  ENABLE_CORS: "true"
  ENABLE_DOCS: "true"     # Swagger UI
  ENABLE_METRICS: "true"  # Prometheus metrics
  
  # --------------------------------------------------------------------------
  # Rate Limiting
  # --------------------------------------------------------------------------
  RATE_LIMIT_ENABLED: "true"
  RATE_LIMIT_PER_MINUTE: "100"
  
  # --------------------------------------------------------------------------
  # Batch Settings
  # --------------------------------------------------------------------------
  MAX_BATCH_SIZE: "100"
  BATCH_TIMEOUT_SECONDS: "30"

---
# ============================================================================
# ConfigMap - Model Metadata
# ============================================================================
# Metadados do modelo (pode ser gerado pelo pipeline de treino)
# ============================================================================

apiVersion: v1
kind: ConfigMap
metadata:
  name: model-metadata
  namespace: default

data:
  model_info.json: |
    {
      "model_version": "v1.0.0",
      "model_type": "RandomForestClassifier",
      "trained_at": "2024-12-01T10:00:00Z",
      "git_commit": "abc123def456",
      "metrics": {
        "test_accuracy": 0.8656,
        "test_f1": 0.8839,
        "test_precision": 0.8571,
        "test_recall": 0.9123
      },
      "hyperparameters": {
        "n_estimators": 100,
        "max_depth": 10,
        "min_samples_split": 5,
        "min_samples_leaf": 2,
        "class_weight": "balanced"
      }
    }

# ============================================================================
# USO NO DEPLOYMENT
# ============================================================================
#
# Para usar ConfigMap no pod, adicionar no deployment.yaml:
#
# env:
# - name: LOG_LEVEL
#   valueFrom:
#     configMapKeyRef:
#       name: wine-quality-config
#       key: LOG_LEVEL
#
# Ou montar como arquivo:
#
# volumes:
# - name: config-volume
#   configMap:
#     name: wine-quality-config
#
# volumeMounts:
# - name: config-volume
#   mountPath: /app/config
#
# ============================================================================